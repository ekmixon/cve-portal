#!/usr/bin/env python2
# -*-coding:UTF-8 -*


def vendors(r):
    return r.sunion('t:/a', 't:/h', 't:/o')


def vendor_products(r, vendor):
    products = r.smembers(f'v:{vendor}')
    return list(products)


def get_vendor(r, product):
    allvendors = r.sunion('t:/a', 't:/h', 't:/o')
    return [
        vendor
        for vendor in allvendors
        if product in vendor_products(r, vendor)
    ]


def product_versions(r, product):
    versions = r.smembers(f'p:{product}')
    return list(versions)


def search_vendor(r, search):
    return [vendor for vendor in vendors(r) if search in vendor]


def search_product(r, search):
    result = []
    for vendor in vendors(r):
        result.extend(
            product
            for product in vendor_products(r, vendor)
            if search in product
        )

    return result


def search_vendor_product(r, search, vendor):
    return [product for product in vendor_products(r, vendor) if search in product]
